% !center 188 | frame -f '\%-\% ' 188
%----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------%
%                                                                                          Title Page                                                                                          %
%----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------%

\thispagestyle{empty} % Removes page numbering from the first page
\flushbottom % Makes all text pages the same height
\maketitle % Print the title and abstract box


%----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------%
%                                                                                           License                                                                                            %
%----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------%

\section*{License}

    \scriptsize\noindent%
    \begin{minipage}{\columnwidth}
        \centering\tt
        \includegraphics[height=6.0mm]{cc/by.pdf}\\[0.5\smallskipamount]
        {\scriptsize\url{https://creativecommons.org/licenses/by/4.0/}}
    \end{minipage}
    \normalsize


%----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------%
%                                                                                      Table Of Contents                                                                                       %
%----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------%

\tableofcontents


%----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------%
%                                                                                         Nomenclature                                                                                         %
%----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------%

\section*{Nomenclature}
\addcontentsline{toc}{section}{Nomenclature}

% Primary nomenclature lengths
\newlength{\lencsep}\setlength{\lencsep}{0.8em} % column separation width
\newlength{\lensymb}\setlength{\lensymb}{3.5em} % symbol column width
\newlength{\lendefn}\setlength{\lendefn}{4.5em} % definition column width
% Derived nomenclature lengths
\newlength{\lensybb}\setlength{\lensybb}{\lensymb}
\addtolength{\lensybb}{-\lencsep}
\newlength{\lenwhat}\setlength{\lenwhat}{\linewidth}
\addtolength{\lenwhat}{-\lensymb}
\addtolength{\lenwhat}{-\lendefn}
\newlength{\lenwhab}\setlength{\lenwhab}{\lenwhat}
\addtolength{\lenwhab}{-\lencsep}
\newlength{\lenWHAT}\setlength{\lenWHAT}{\linewidth}
\addtolength{\lenWHAT}{-\lensymb}
% Nomenclature commands
\newcommand{\tcs}[1]{\parbox[t]{\lensybb}{\ensuremath {#1}}}    % tabbing column for symbol
\newcommand{\tcw}[1]{\parbox[t]{\lenwhab}{\raggedright{#1}}}    % tabbing column for what (explanation)
\newcommand{\tcW}[1]{\parbox[t]{\lenwhab}{{#1}}}                % tabbing column for what (explanation)
\newcommand{\tcd}[1]{\parbox[t]{\lendefn}{\raggedright{#1}}}    % tabbing column for definition

\begin{tabbing}\hspace*{\lensymb}\=\hspace*{\lenwhat}\=\hspace*{\lendefn}\kill
    {\em Latin symbols:} \\
    \tcs{a}                 \> \tcw{Specific heat model coefficients, (variable),}                                                      \> \tcd{Eq.~(\ref{eq:cp})}                          \\
    \tcs{c}                 \> \tcw{Chemical amount for the \ce{CO}, \kilo\mole,}                                                       \> \tcd{Tab.~\ref{tab:molBal}, Eq.~(\ref{eq:c})}    \\
    \tcs{\bar{c}}           \> \tcw{Molar-base specific heat, \kilo\joule\per\kilo\mole\usk\kelvin,}                                    \> \tcd{Eq.~(\ref{eq:cp})}                          \\
    \tcs{D}                 \> \tcw{Piston diameter, \meter,}                                                                           \> \tcd{Eq.~(\ref{eq:S})}                           \\
    \tcs{\mathtt{g}}        \> \tcw{Fitting auxiliary function, ---,}                                                                   \> \tcd{Eqs.~(\ref{eq:zeta}), (\ref{eq:zeta.g})}    \\
    \tcs{\bar{h}}           \> \tcw{Molar-base specific enthalpy, \kilo\joule\per\kilo\mole,}                                           \> \tcd{Eq.~(\ref{eq:H.comp})}                      \\
    \tcs{H}                 \> \tcw{Enthalpy, \kilo\joule,}                                                                             \> \tcd{Eq.~(\ref{eq:H.comp})}                      \\
    \tcs{k}                 \> \tcw{Mixture component index, ---,}                                                                      \> \tcd{Sec.~\ref{sec:model.reactm}}                \\
    \tcs{K}                 \> \tcw{Reaction equilibrium constant, ---,}                                                                \> \tcd{Eq.~(\ref{eq:K})}                           \\
    \tcs{L}                 \> \tcw{Connecting rod length, \meter,}                                                                     \> \tcd{Eq.~(\ref{eq:x})}                           \\
    \tcs{m}                 \> \tcw{Mass, \kilogram,}                                                                                   \> \tcd{Eq.~(\ref{eq:mf})}                          \\
    \tcs{\mathbb{M}}        \> \tcw{Mixture, ---,}                                                                                      \> \tcd{Eq.~(\ref{eq:MXAIR})--(\ref{eq:MXREA})}     \\
    \tcs{\mathrm{mf}}       \> \tcw{Mass fraction, ---,}                                                                                \> \tcd{Eq.~(\ref{eq:mf})}                          \\
    \tcs{n}                 \> \tcw{Chemical amount, \kilo\mole,}                                                                       \> \tcd{Eq.~(\ref{eq:nm})}                          \\
    \tcs{n}                 \> \tcw{Fuel composition parameter, \kilo\mole,}                                                            \> \tcd{Eq.~(\ref{eq:epsilon})}                     \\
    \tcs{N}                 \> \tcw{Engine's rotation, RPM,}                                                                            \> \tcd{Sec.~\ref{sec:model.engine}}                \\
    \tcs{p}                 \> \tcw{Mixture component count, ---,}                                                                      \> \tcd{Sec.~\ref{sec:model.reactm}}                \\
    \tcs{P}                 \> \tcw{Thermodynamic pressure, \kilo\pascal,}                                                              \> \tcd{Eq.~(\ref{eq:uf0})}                         \\
    \tcs{r}                 \> \tcw{Ratio (engine compression), ---,}                                                                   \> \tcd{Eq.~(\ref{eq:r})}                           \\
    \tcs{R}                 \> \tcw{Crank radius, \meter,}                                                                              \> \tcd{Eq.~(\ref{eq:S})}                           \\
    \tcs{\bar{R}}           \> \tcw{The universal gas constant, \kilo\joule\per\kilo\mole\usk\kelvin,}                                  \> \tcd{Sec.~\ref{sec:model.reactm}}                \\
    \tcs{S}                 \> \tcw{Piston stroke, \meter,}                                                                             \> \tcd{Eq.~(\ref{eq:S})}                           \\
    \tcs{t}                 \> \tcw{Time, \second,}                                                                                     \> \tcd{Sec.~\ref{sec:model.engine}}                \\
    \tcs{T}                 \> \tcw{Thermodynamic temperature, \kelvin,}                                                                \> \tcd{Eq.~(\ref{eq:cp})}                          \\
    \tcs{\bar{u}}           \> \tcw{Molar-base specific internal energy, \kilo\joule\per\kilo\mole,}                                    \> \tcd{Eq.~(\ref{eq:U.comp})}                      \\
    \tcs{U}                 \> \tcw{Internal energy, \kilo\joule,}                                                                      \> \tcd{Eq.~(\ref{eq:U.comp})}                      \\
    \tcs{v}                 \> \tcw{Mass-base specific volume, \meter\cubed\per\kilogram,}                                              \> \tcd{Eq.~(\ref{eq:?})}                           \\
    \tcs{V}                 \> \tcw{Volume, \meter\cubed,}                                                                              \> \tcd{Eqs.~(\ref{eq:S}), (\ref{eq:V})}            \\
    \tcs{w}                 \> \tcw{Uncertainty of, (variable),}                                                                        \> \tcd{Eq.~(\ref{eq:cp})}                          \\
    \tcs{\mathrm{y}}        \> \tcw{Molar fraction, ---,}                                                                               \> \tcd{Eq.~(\ref{eq:y})}                           \\
    \tcs{z}                 \> \tcw{Engine's cylinder count, ---,}                                                                      \> \tcd{Sec.~\ref{sec:model.engine}}                \\
\end{tabbing}

\begin{tabbing}\hspace*{\lensymb}\=\hspace*{\lenwhat}\=\hspace*{\lendefn}\kill
    {\em Greek symbols:} \\
    \tcs{\alpha}            \> \tcW{Crank angular position, \rad,}                                                                      \> \tcd{Eq.~(\ref{eq:x})}                           \\
    \tcs{\beta}             \> \tcW{Chemical equilibrium solution term, ---,}                                                           \> \tcd{Eqs.~(\ref{eq:c}), (\ref{eq:beta})}         \\
    \tcs{\gamma}            \> \tcW{Chemical equilibrium solution term, ---,}                                                           \> \tcd{Eqs.~(\ref{eq:c}), (\ref{eq:gamma})}        \\
    \tcs{\epsilon}          \> \tcW{Amount of fuel per {\kilo\mole} of \ce{O2} that is stoichiometrically oxidized with\-out forming                                                 
                                    Nitrogen oxides, \kilo\mole,}                                                                       \> \tcd{Eq.~(\ref{eq:epsilon})}                     \\
    \tcs{\zeta}             \> \tcW{Gas products residual fraction from one cycle to the next, ---,}                                    \> \tcd{Eq.~(\ref{eq:zeta})}                        \\
    \tcs{\phi}              \> \tcW{Actual-to-stoichiometric ratio of fuel-to-air ratios, or the equivalence ratio, ---,}               \> \tcd{Eq.~(\ref{eq:phi})}                         \\
    \tcs{\psi}              \> \tcW{Inert-to-oxidant gas molar ratio for the air model, ---,}                                           \> \tcd{Eq.~(\ref{eq:phi})}                         \\
    \tcs{\omega}            \> \tcW{Crank angular velocity, \rad\per\second,}                                                           \> \tcd{Sec.~\ref{sec:model.engine}}                \\
\end{tabbing}

\begin{tabbing}\hspace*{\lensymb}\=\hspace*{\lenWHAT}\kill
    {\em Subscripts:} \\
    \tcs{{}_0}                                  \> end of admission stroke conditions                                                                                                       \\
    \tcs{{}_{\mbox{\scriptsize\tt a}}}          \> that of air mixture                                                                                                                      \\
    \tcs{{}_{\mbox{\scriptsize\tt af}}}         \> that of air-fuel mixture                                                                                                                 \\
    \tcs{{}_{\mbox{\scriptsize air}}}           \> that of air                                                                                                                              \\
    \tcs{{}_{any}}                              \> of any value                                                                                                                             \\
    \tcs{{}_{\bdc}}                             \> Bottom Dead Center, BDC                                                                                                                  \\
    \tcs{{}_{\mbox{\scriptsize \ce{C}}}}        \> that of atomic Carbon                                                                                                                    \\
    \tcs{{}_{\mbox{\scriptsize \ce{CO}}}}       \> that of Carbon Monoxide molecule                                                                                                         \\
    \tcs{{}_{\mbox{\scriptsize \ce{CO2}}}}      \> that of Carbon Dioxide molecule                                                                                                          \\
    \tcs{{}_d}                                  \> displaced                                                                                                                                \\
    \tcs{{}_f}                                  \> of formation                                                                                                                             \\
    \tcs{{}_{\mbox{\scriptsize f}}}             \> that of fuel                                                                                                                             \\
    \tcs{{}_{\mbox{\scriptsize\tt f}}}          \> that of fuel mixture                                                                                                                     \\
    \tcs{{}_{\mbox{\scriptsize \ce{H}}}}        \> that of atomic Hydrogen                                                                                                                  \\
    \tcs{{}_{\mbox{\scriptsize \ce{H2}}}}       \> that of Hydrogen molecule                                                                                                                \\
    \tcs{{}_{\mbox{\scriptsize \ce{H2O}}}}      \> that of Water molecule                                                                                                                   \\
    \tcs{{}_i}                                  \> process index                                                                                                                            \\
    \tcs{{}_{LR}}                               \> relative to $L/R$ (usually a ratio)                                                                                                      \\
    \tcs{{}_m}                                  \> mixture                                                                                                                                  \\
    \tcs{{}_{max}}                              \> maximum                                                                                                                                  \\
    \tcs{{}_{min}}                              \> minimum                                                                                                                                  \\
    \tcs{{}_{\mbox{\scriptsize \ce{N}}}}        \> that of atomic Nitrogen                                                                                                                  \\
    \tcs{{}_{\mbox{\scriptsize \ce{N2}}}}       \> that of Nitrogen molecule                                                                                                                \\
    \tcs{{}_{\mbox{\scriptsize \ce{O}}}}        \> that of atomic Oxygen                                                                                                                    \\
    \tcs{{}_{\mbox{\scriptsize \ce{O2}}}}       \> that of Oxygen molecule                                                                                                                  \\
    \tcs{{}_p}                                  \> at constant-pressure                                                                                                                     \\
    \tcs{{}_{\mbox{\scriptsize\tt pr}}}         \> that of combustion products mixture                                                                                                      \\
    \tcs{{}_{\mbox{\scriptsize\tt re}}}         \> that of combustion reagents mixture                                                                                                      \\
    \tcs{{}_{SD}}                               \> relative to $S/D$ (usually a ratio)                                                                                                      \\
    \tcs{{}_{\tdc}}                             \> Top Dead Center, TDC                                                                                                                     \\
    \tcs{{}_u}                                  \> unitary or unit                                                                                                                          \\
    \tcs{{}_v}                                  \> at constant-specific volume                                                                                                              \\
\end{tabbing}
                                                                                                                      
\begin{tabbing}\hspace*{\lensymb}\=\hspace*{\lenWHAT}\kill
    {\em Superscripts:} \\                                                                       
    \tcs{{}^0}                                  \> at the standard reference state \tcs{(P_0, T_0)}                                                                                         \\
\end{tabbing}

\begin{tabbing}\hspace*{\lensymb}\=\hspace*{\lenWHAT}\kill
    {\em Chemical species:} \\                                                                       
    \tcs{\ce{C}}                                \> Carbon (atomic)                                                                                                                          \\
    \tcs{\ce{CO}}                               \> Carbon monoxide                                                                                                                          \\
    \tcs{\ce{CO2}}                              \> Carbon dioxide                                                                                                                           \\
    \tcs{\ce{H}}                                \> Hydrogen (atomic)                                                                                                                        \\
    \tcs{\ce{H2}}                               \> Hydrogen (molecular)                                                                                                                     \\
    \tcs{\ce{H2N2}}                             \> Hydrazine                                                                                                                                \\
    \tcs{\ce{H2O}}                              \> Water                                                                                                                                    \\
    \tcs{\ce{N}}                                \> Nitrogen (atomic)                                                                                                                        \\
    \tcs{\ce{N2}}                               \> Nitrogen (molecular)                                                                                                                     \\
    \tcs{\ce{O}}                                \> Oxygen (atomic)                                                                                                                          \\
    \tcs{\ce{O2}}                               \> Oxygen (molecular)                                                                                                                       \\
\end{tabbing}


%----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------%
%                                                                                         Introduction                                                                                         %
%----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------%

\section{Introduction}

    The treatment of Otto cycles in undegraduate  engineering  thermodynamics  courses  typically  begins  with  the  ideal,  air-standard  model,  that  is  characterized  by  isochoric  heat
    interactions~\cite{2014-CengelYA+BolesMA-McGrawHill, 2002-MoranMJ+ShapiroHN-LTC, 1985-WylenG-Wiley, 2015-KroosKA+PotterMC-Cengage}. More advanced courses may include  an  air-fuel  version
    that maintains the isochoric release of internal energy due to the combustion  reaction~\cite{2012-BrunettiF-Blucher}.  Due  to  the  continuous  piston  motion  on  traditional  crank-rod
    reciprocating  engines,  isochoric  heating,  or,  conversely,  internal  energy  release  from  combustion,  represent  \emph{instantaneous}  process  for  engines   running   at   finite
    speed~\cite{2017-NaaktgeborenC-IntJMechEngEduc}.

    In one hand, by acccounting for air-fuel reactive mixtures, models can more precisely capture variations in mixture caloric properties along the compression and expansion  processes,  thus
    providing an extra degree of refinement in work calculations~\cite{2012-BrunettiF-Blucher}, as well as being able to derive a more direct relationship  between  work  production  and  fuel
    consumption, if the internal energy release is calculated from the chemical reaction.

    On the other hand, by neglecting the finite rate of reaction or internal energy release with isochoric reaction, the model ignores key effects of simultaneous heat  and  work  interactions
    that shape experimental $P-v$ cycle curves away from the ones modeled with isochoric heating or reaction~\cite{2013-MartinsJJG-Publindustria}. Therefore, the isochoric  heating  hypothesis
    can be more idealized than the one that replaces combustion by an external heating---so that it may make  more  sense  to  abandon  the  isochoric  heating  hypothesis  before  introducing
    combustion as to yield progressive model refinements.

    Doing so has the advantage of remaining at pure-substance thermodynamics while making significant improvements on the cycle model, especially in terms of the variety of parameters that can
    be easily introduced. One such model, labeled `FTHA'\footnote{FTHA is the acronym of Finite-Time Heat Addition.}, has been recently proposed~\cite{2017-NaaktgeborenC-IntJMechEngEduc} as  a
    middle step towards the modeling of air-fuel Otto cycles in the context of mechanical engineering education.

    In order to incorporate in a single model effects of (i)~finite duration of the combustion process, and of (ii)~reactive mixture properties, this work proposes a finite-time air-fuel  Otto
    engine model, labeled `FTAF'\footnote{FTAF is the acronym of Finite-Time Air-Fuel.}, also in the context of mechanical engineering education.  Thus,  the  model  herein  presented  can  be
    thought  of  as  a   \emph{merge}   between   two   existing   schemes:   (i)~a   \emph{modified}   version   of   the   isochoric   air-fuel   model   presented   by   Brunetti   \emph{et
    al.\/}~\cite{2012-BrunettiF-Blucher}, as to avoid being limited to carbon-based fuels~\footnote{This shortcomming comes artificially by the way the combustion reaction is  normalized,  and
    unnecessarily prevents fuels such as pure Hydrogen, \ce{H2}, or Hydrazine, \ce{H2N2}, from being simulated.}, and (ii)~the FTHA model~\cite{2017-NaaktgeborenC-IntJMechEngEduc}.

    The model herein proposed keeps undergraduate mechanical engineering education as its audience, and differs from other models in the sense that it avoids further complications  present  in
    other  models,  such  as  friction  and/or  heat  transfer  irreversibilities~\cite{2008-CurtoRissoPL+HernandezAC-JApplPhys,  2002-CatonJA-IntJMechEngEduc},  intake   and   exit   manifold
    flows~\cite{2001-CatonJA-IntJMechEngEduc}, as well as forming a complete, ready to teach unit, rather than a  collection  of  add-on  models---including  a  finite  interval  heat  release
    one---than can be selected and taylored for a given application~\cite{2013-MartinsJJG-Publindustria}. Moreover,  the  model  proposed  in  this  work  is  intended  to  be  computationally
    implemented by the students, whether in whole or in part, rather than being presented as a simulation-ready tool~\cite{2011-ZuecoJ-IntJMechEngEduc}.


%----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------%
%                                                                                      Model Formulation                                                                                       %
%----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------%

\section{Model Formulation}\label{sec:model}

    The proposed finite-time air-fuel model comprises an (i)~engine model, a (ii)~reactive mixture model, a (iii)~combustion and chemical equilibrium model, and a (iv)~cycle model. Models  (i)
    and (iv) herein presented closely follow the FTHA ones~\cite{2017-NaaktgeborenC-IntJMechEngEduc}, incorporating minor formulation and discretization changes.  Present  model  (ii)  of  the
    current work expands upon the FTHA one in the sense that a reactive mixture replaces the pure substance; the mixture, however, remains an ideal one with variable specific heats. The  model
    (iii) of the present work, entirely absent in the air-standard FTHA, expands upon the scheme of Brunetti~\cite{2012-BrunettiF-Blucher} in the energy balance,  fluid  formulations,  and  on
    residual gas fractions.


    %-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    \subsection{Engine model}\label{sec:model.engine}

    The thermodynamic system is considered as the volume comprised of the closed-valves combustion chamber surfaces of a standard crank-rod reciprocating internal combustion  engine  (ICE)  of
    displaced volume $V_d$, \meter\cubed, $z$ cylinders, and $V_{du} = V_d / z$ unit cylinder displacement volume, \meter\cubed. Combustion chamber minimum and maximum volumes are $V_\tdc$ and
    $V_\bdc$ for the top and bottom dead centers, respectively.

    The cylinder diameter is $D$, the piston stroke is $S$, the rod length is $L$, and the crank radius is $R$, all in \meter. Important ratios include the stroke-to-diameter  one,  $r_{SD}  =
    S/D$, the rod-to-crank one, $r_{LR} = L/R > 1$, the engine compression ratio $r$, so that%
    %
    \begin{align}
        \label{eq:S}
        S       &= 2 R = \frac{4 V_{du}}{\pi D^{2}}, \\
        \label{eq:Vdu}
        V_{du}  &= V_\bdc - V_\tdc = \frac{\pi SD^2}{4}, \quad\mbox{and} \\
        \label{eq:r}
        r       &= \frac{V_\bdc}{V_\tdc} = 1 + \frac{V_{du}}{V_\tdc}.
    \end{align}

    The crankshaft angular position $\alpha$, in \radian, and engine angular velocity $\omega$, in \radian\per\second, and the engine RPM $N$, are related by $d\alpha/dt = \omega = 2\pi N/60$,
    in which $\alpha$ is an integer multiple of $\unit{2\pi}{\radian}$ whenever the piston is at the TDC. Constant-$\omega$ cases have $\alpha = \omega t$ with $t =  \unit{0}{\second}$  at  an
    arbitrary TDC. Moreover, the piston position $x$ with respect to the TDC, in \meter, is expressed as%
    %
    \begin{equation}
        \label{eq:x}
        x(\alpha) = \left|
                \left[\begin{matrix}L & R\end{matrix}\right] \times
                \left[\;\begin{matrix}
                    1 - \sqrt{\smash[b]{1 - (\sin\alpha / r_{LR})^2}} \\
                    1 - \cos\alpha
                \end{matrix}\;\right]
            \right|.
    \end{equation}%

    The thermodynamic system \emph{instantaneous} volume $V$ is therefore given by%
    %
    \begin{equation}
        \label{eq:V}
        V(\alpha) = V_\tdc + \frac{\pi D^2}{4}x(\alpha).
    \end{equation}

    The engine model, being comprised of simple algebric equations, is left for the students to implement.


    %-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    \subsection{Reactive mixture model}\label{sec:model.reactm}

    The reactive mixture is comprised of $p$ pure components, refered to by their $k$ index. By hypothesis, the mixture displays an ideal $P$-$v$-$T$ behavior. Elementary mixture  definitions,
    in which the ``$m$'' subscript indicates ``mixture'', include:%
    %
    \begin{align}
        \label{eq:mf}
        \mathrm{mf}_k   &= \frac{m_k}{m_m}, \\
        \label{eq:y}
        \mathrm{y}_k    &= \frac{n_k}{n_m}, \\
        \label{eq:mm}
        m_m             &= \sum_{k=1}^p m_k, \quad\mbox{and} \\
        \label{eq:nm}
        n_m             &= \sum_{k=1}^p n_k,
    \end{align}
    %
    \noindent where $\mathrm{mf}$ and $\mathrm{y}$ are mixture component mass fractions and molar fractions, respectively. Terms $m$ and $n$ are mass, in \kilogram,  and  chemical  amount,  in
    \kilo\mole, respectively.

    The apparent mixture molar mass $M_m$, in \kilogram\per\kilo\mole, and apparent mixture constant, $R_m$, in \kilo\joule\per\kilogram\usk\kelvin, and mixture (ideal) equation of  state  are
    given by:%
    %
    \begin{align}
        \label{eq:Mm}
        M_m         &= \frac{m_m}{n_m} = \sum_{k=1}^p \mathrm{y}_k M_k, \\
        \label{eq:Rm}
        R_m         &= \frac{\bar{R}}{M_m}, \quad\mbox{and} \\
        \label{eq:mEoS}
        P_mV_m      &= n_m\bar{R}T_m.
    \end{align}

    Let the components' molar specific heat at constant pressure, $\bar{c}_{p,k}$, in \kilo\joule\per\kilo\mole\usk\kelvin, be modeled as a function of temperature, with  auxiliar  parameters,
    in the form:%
    %
    \begin{equation}
        \bar{c}_{p,k}(T) \eqmod \sum_{i=-4}^4 a_iT^i \pm w_{cp}, \quad T_{min} \leqslant T \leqslant T_{max}.
        \label{eq:cp}
    \end{equation}

    Models like this are frequently associated with a maximum and/or average uncertainties, $w_{cp}$, and validity temperature intervals, $[T_{min},  T_{max}]$;  which  are  either  listed  in
    Thermodynamics texts~\cite{2014-CengelYA+BolesMA-McGrawHill, 1985-WylenG-Wiley} or can be found by a suitable data modeling (regression) procedure.

    By using the ideal gas relation of $\bar{c}_{v,k}(T) = \bar{c}_{p,k}(T) - \bar{R}$, allows one to find component enthalpy and internal energy by a suitable integration.

    Let the enthalpy of a reactive mixture component $k$ portion (of $\unit{n_k}{\kilo\mole}$) at a given temperature $T$ be:%
    %
    \begin{align}
        H_k(T)      &= n_k\bar{h}_k(T) \nonumber\\
                    &= n_k[\bar{h}^0_{f,k} + \bar{h}^0_k(T)] \nonumber\\
                    &= n_k\left[
                        \bar{h}^0_{f,k} + \int_{T_0}^T \bar{c}_{p,k}(T)\,dT
                    \right].
        \label{eq:H.comp}
    \end{align}
    %
    \noindent  where  $\bar{h}^0_{f,k}$,  in  \kilo\joule\per\kilo\mole,  is  the  specific  molar  enthalpy  of  formation  of  substance  $k$  at  the  standard  state  $(P_0,  T_0)   \equiv
    (\unit{1}{\mathrm{atm}}, \unit{298.15}{\kelvin})$; $\bar{h}^0_k(T)$ is the substance $k$ specific molar ideal gas enthalpy of state $(P_{\mathrm{any}}, T)$ with  respect  to  the  standard
    state $(P_0, T_0)$. The bracketed term $\bar{h}_k(T)$ is the substance $k$ specific molar enthalpy with respect to the standard state considering its chemical composition.

    Casting analogous internal energy relations in the form of Eq.~(\ref{eq:H.comp}), one has:%
    %
    \begin{align}
        U_k(T)      &= n_k\bar{u}_k(T) \nonumber\\
                    &= n_k[\bar{u}^0_{f,k} + \bar{u}^0_k(T)] \nonumber\\
                    &= n_k\left[
                        \bar{u}^0_{f,k} + \int_{T_0}^T \bar{c}_{v,k}(T)\,dT
                    \right].
        \label{eq:U.comp}
    \end{align}

    Using $H_k(T) = U_k(T) + PV = U_k(T) + n_k\bar{R}T$, then the definition of $\bar{u}^0_{f,k}$ must be%
    %
    \begin{equation}
        \bar{u}_f^0 \equiv \bar{h}_f^0 - P_0\bar{v}_0 = \bar{h}_f^0 - \bar{R}T_0.
        \label{eq:uf0}
    \end{equation}

    The internal energy expression for the \emph{mixture} in terms of component internal energies is%
    %
    \begin{equation}
        U_m(T) = \sum_{k=1}^p U_k(T) \equiv U^0_{f,m} + U^0_m(T),
        \label{eq:U.mix}
    \end{equation}
    %
    \noindent in which Eqs.~(\ref{eq:U.comp}), and~(\ref{eq:uf0}) can be used as to derive explicit expressions for $U^0_{f,m}$%
    %
    \begin{align}
        U^0_{f,m}   &= \sum_{k=1}^p n_k\bar{u}^0_{f,k} \nonumber\\
                    &= \sum_{k=1}^p n_k\bar{h}_f^0 - n_m\bar{R}T_0 \nonumber\\
                    &= H^0_{f,m} - n_m\bar{R}T_0,
        \label{eq:Uf0.mix}
    \end{align}
    %
    \noindent and for $U^0_m(T)$%
    %
    \begin{align}
        U^0_m(T)    &= \sum_{k=1}^p n_k\bar{u}^0_k(T) \nonumber\\
                    &= \sum_{k=1}^p n_k \int_{T_0}^T \bar{c}_{v,k}(T)\,dT.
        \label{eq:U0.mix}
    \end{align}


    %-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    \subsection{Combustion and chemical equilibrium model}\label{sec:model.cchemm}

    Following the scheme of Brunetti~\cite{2012-BrunettiF-Blucher}, a general combustion reaction between a fuel model and an air model is to be balanced (solved) in terms of  air,  fuel,  and
    mixture dimensionless parameters. Contrary to the scheme of that reference, in this work, no fuel Carbon content normalization is  going  to  be  performed,  which  unnecessarily  prevents
    non-carbon fuels, such as Hydrogen, \ce{H2}, or Hydrazine, \ce{H2N2}, from being employed in simulations~\cite{2018-SilvaRKO-UTFPR}.

    The air is modeled as a mixture of \ce{O2} and of \ce{N2} gases with a proportion of $\psi$ {\kilo\mole} of \ce{N2} per {\kilo\mole} of \ce{O2}. As the Nitrogen will  be  kept  inert,  all
    inert gases are modeled as \ce{N2}. A typical value of $\psi$ is $79/21 \approx 3.76$.

    Fuel is generically modeled as a \ce{C\NC H\NH O\NO N\NN} mol\-e\-cule, in which \NC, \NH, \NO, and {\NN} are adjustable parameters. Let $\epsilon$ be the amount of fuel  per  {\kilo\mole}
    of \ce{O2} that is stoichiometrically oxidized without forming Nitrogen oxides, therefore,%
    %
    \begin{equation}
        \epsilon^{-1} \equiv \NC + \frac{\NH}{4} - \frac{\NO}{2},
        \label{eq:epsilon}
    \end{equation}
    %
    \noindent so that $\epsilon / (1 + \psi)$ is the stoichiometric fuel-to-air ratio.

    Let $\phi$ be the actual-to-stoichiometric ratio of fuel-to-air ratios, or the equivalence ratio, i.e.,%
    %
    \begin{equation}
        \phi \equiv \frac{\NF/\NA}{\epsilon / (1 + \psi)},
        \label{eq:phi}
    \end{equation}
    %
    \noindent so that $\phi < 1$ models an excess-air mixture, $\phi < 1$ an excess-fuel, and $\phi = 1$ a stoichiometric mixture. Actual amounts of air and fuel, {\NA} and  \NF,  that  occupy
    the closed combustion chamber at the end of the admission stroke, assuming $(P_0, V_0, T_0)$ conditions thereof;  $P_0  \leqslant  P_{\mathrm{atm}}$,  $T_0  \approx  T_{\mathrm{atm}}$  for
    aspirated engines and $V_0 \approx V_\bdc$; are:%
    %
    \begin{align}
        \label{eq:nf}
        \NF     &= \frac{P_0V_0}{\bar{R}T_0}\cdot\frac{\phi\epsilon}{1 + \psi + \phi\epsilon}, \\
        \label{eq:na}
        \NA     &= \frac{P_0V_0}{\bar{R}T_0}\cdot\frac{1 + \psi}{1 + \psi + \phi\epsilon}.
    \end{align}

    The combustion reaction is therefore:%
    %
    \begin{multline}
        \NF\,\mbox{\ce{C\NC H\NH O\NO N\NN}} +\\
        \NA\left(
            \frac{1}{1+\psi}\mbox{\ce{O2}} +
            \frac{\psi}{1+\psi}\mbox{\ce{N2}}
        \right) \ce{->} \\ \shoveright
        {\NCOO\mbox{\ce{CO2}} +
        \NHHO\mbox{\ce{H2O}} +
        \NCO\mbox{\ce{CO}} +} \\
        \NHH\mbox{\ce{H2}} +
        \NOO\mbox{\ce{O2}} +
        \NNN\mbox{\ce{N2}}.
        \label{eq:comb}
    \end{multline}

    By hypothesis, the combustion reaction goes to completion whenever possible, i.e., whenever $\phi \leqslant 1$, so that Carbon and Hydrogen  are  fully  oxidized  into  \ce{CO2}  and  into
    \ce{H2O}, leaving no room for formation of \ce{CO} and of \ce{H2} products. On the other hand, whenever $\phi > 1$, completion hypothesis mean all \ce{O2}  is  used  up  for  complete  and
    partial oxidation of fuel Carbon and Hydrogen, leaving no room for residual \ce{O2} in the products.

    For $\phi \leqslant 1$ under completion hypothesis, Eq.~(\ref{eq:comb}) has enough information as to allow for the molar balance between reagents and products. On the contrary, when  $\phi
    > 1$ there isn't enough information for the molar balance between reagents and products. Closure is obtained by considering the so-called water gas shift (equilibrium) reaction,%
    %
    \begin{equation}
        \mbox{\ce{CO2 + H2 <=> CO + H2O}},
        \label{eq:wgsr}
    \end{equation}
    %
    \noindent and using the equilibrium reaction constant at a given temperature,%
    %
    \begin{equation}
        K(T) = \frac{\NHHO\NCO}{\NCOO\NHH},
        \label{eq:K}
    \end{equation}
    %
    \noindent one gathers enough equations as to perform the molar balance between products and reagents. Brunetti~\cite{2012-BrunettiF-Blucher} employs $K(\unit{1740}{\kelvin})  =  3.5$  with
    the auxiliar variable $c\equiv\NCO$. Using the same method, Table~\ref{tab:molBal} lists balanced reaction product coefficients.

    \begin{table*}[ht]
        \centering
        \caption{Molar balance results for the combustion and water gas shift reactions, Eqs.~(\ref{eq:comb}) and~(\ref{eq:wgsr}) in terms of the equivalence ratio $\phi$}
        \vspace{4pt}
        \begin{tabular}{ccc}
            \toprule
            $n_k$   & air-rich, $\phi \leqslant 1$      & fuel-rich, $\phi > 1$     \\
            \midrule
            $\quad$\NCOO$\quad$ & $\NC\NF \;=\; \NC\dfrac{\phi\epsilon}{1+\psi}\NA$
                                & $\NC\NF - c \;=\; \NC\dfrac{\phi\epsilon}{1+\psi}\NA - c$
                                \\[\bigskipamount]
            \NHHO               & $\frac{\NH}{2}\NF \;=\; \dfrac{\NH}{2}\frac{\phi\epsilon}{1+\psi}\NA$
                                & $(\NO-2\NC)\NF + \dfrac{2}{1+\psi}\NA + c$
                                \\[\bigskipamount]
            \NCO                & $0$
                                & $c$
                                \\[\bigskipamount]
            \NHH                & $0$
                                & $\quad$$\dfrac{2(\phi-1)}{\phi\epsilon}\NF - c \;=\; \dfrac{2(\phi-1)}{1+\psi}\NA - c$$\quad$
                                \\[\bigskipamount]
            \NOO                & $\quad$$(1-\phi)\dfrac{\NA}{1+\psi} \;=\; (1-\phi)\dfrac{\NF}{\phi\epsilon}$$\quad$
                                & $0$
                                \\[\bigskipamount]
            \NNN                & $\dfrac{\psi}{1+\psi}\NA + \dfrac{\NN}{2}\NF$
                                & $\dfrac{\psi}{1+\psi}\NA + \dfrac{\NN}{2}\NF$
                                \\
            \bottomrule
        \end{tabular}
        \label{tab:molBal}
    \end{table*}

    Plugging in Table~\ref{tab:molBal} results for $\phi > 1$ onto Eq.~(\ref{eq:K}) yields a quadratic equation for $c$ whose solution may be written as:%
    %
    \begin{flalign}
        \label{eq:c}
        \frac{c}{\NF}   &= -\beta \pm \sqrt{\beta^2 - \gamma}, \qquad\mbox{with} \\
        \label{eq:gamma}
        \gamma          &= \dfrac{2\NC(\phi-1)}{\phi\epsilon(K-1)}, \qquad\mbox{and} \\
        \label{eq:beta}
        \beta           &= \dfrac{\phi\epsilon[(2-K)\NC-\NO] + 2[K(\phi-1)+1]}{2(K-1)\phi\epsilon}.
    \end{flalign}

    Let $\zeta$ be the residual fraction of gas products from a previous cycle that remain in the system for a new cycle. Using the relationship given by Silva~\cite{2018-SilvaRKO-UTFPR}  from
    the data available in Heywood~\cite{1988-HeywoodJB-McGrawHill}, i.e.,%
    %
    \begin{align}
        \zeta(P, r) &= 17.807 + 6.423\mathtt{g}(r) \nonumber\\
                    &\,- [0.029 + 0.013\mathtt{g}(r)] P \nonumber\\
                    &\,+ [1.828 + 0.798\mathtt{g}(v)] \times 10^{-5} \times P^2,
        \label{eq:zeta}
    \end{align}
    %
    \noindent with%
    %
    \begin{equation}
        \mathtt{g}(v) = (5.25 - 0.5r) e^{(8.5 - r)},
        \label{eq:zeta.g}
    \end{equation}
    %
    \noindent so that the following mixtures can be defined:%
    %
    \begin{align}
        \label{eq:MXAIR}
        \MXAIR  &=  \NA\left(
                        \frac{1}{1+\psi}\mbox{\ce{O2}} +
                        \frac{\psi}{1+\psi}\mbox{\ce{N2}}
                    \right)
                \\[\medskipamount]
        \label{eq:MXFUE}
        \MXFUE  &=  \NF\,\mbox{\ce{C\NC H\NH O\NO N\NN}}
                \\[\medskipamount]
        \label{eq:MXAFU}
        \MXAFU  &=  \NF\,\mbox{\ce{C\NC H\NH O\NO N\NN}} \nonumber\\
                &\,+\NA\left(
                        \frac{1}{1+\psi}\mbox{\ce{O2}} +
                        \frac{\psi}{1+\psi}\mbox{\ce{N2}}
                    \right)
                \\[\medskipamount]
        \label{eq:MXPRO}
        \MXPRO  &=  \NCOO\mbox{\ce{CO2}} +
                    \NHHO\mbox{\ce{H2O}} +
                    \NCO\mbox{\ce{CO}} \nonumber\\
                &\,+\NHH\mbox{\ce{H2}} +
                    \NOO\mbox{\ce{O2}} +
                    \NNN\mbox{\ce{N2}}
                \\[\medskipamount]
        \label{eq:MXREA}
        \MXREA  &=  (1 - \zeta)\,\MXAFU + (\zeta)\,\MXPRO,
    \end{align}
    %
    \noindent with molar coefficients given by Table~\ref{tab:molBal}.

    Therefore the reactive mixture that comprises the thermodynamic system at the beginning of a cycle is $\MXREA$, i.e., the reagents; while at the end  of  the  cycle,  $\MXPRO$,  i.e.,  the
    products.


    %-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    \subsection{Cycle model}\label{sec:model.cyclem}

    Similarly to the FTHA model~\cite{2017-NaaktgeborenC-IntJMechEngEduc}, the 4-stroke cycle is modeled as a sequence of locally polytropic sub-processes, according to what has been  proposed
    as a general discrete process type on reference~\cite{2020-NaaktgeborenC-Polytropic-engrXiv-rev02}.

    The process discretization of the air-standard FTHA model \emph{separatedly} splits zero-heat, and heating processes into sub-processes of uniform crankshaft angular increments.  This  has
    the advantage of capturing the exact zero-heat to heating process boundaries, and to prescribe different discretization refinements among the  processes,  and  even  to  allow  for  manual
    (coarse) calculations to be done, for instance, in evaluation settings. However, coarse calculations have the disadvantage that the TDC state may not be visited, thus introducing errors in
    work calculations that are likely significant. Evidently the disadvantages fade away whenever sufficiently small crankshaft angular increments are employed in computations.

    In the present model, uniform and sufficiently small crankshaft angular increments are employed, provided that both BDC  and
    TDC states are visited. This means that sub-process crankshaft angular increments ought to  be  an  integer  submultiple  of
    $\unit{180}{\degree} = 2  \cdot  2  \cdot  3  \cdot  3  \cdot  \unit{5}{\degree}$,  or,  conversely,  that  $\Delta\alpha  =
    \unit{180}{\degree} / I$ with $I \in \mathbb{N}^*$, with the simulation starting unphased from the BDC.

    The FTAF concept of cumulative heat release fraction, $y(\alpha)$ is  adapted  into  a  cumulative  fraction  of  combustion
    reaction completion, $y(\alpha)$, with $0 \leqslant y(\alpha) \leqslant 1$, with $g(\alpha)$ being its  functional  form---a
    functional        model        parameter        that        can        follow        literature         proposals         of
    cossenoidal~\cite{2008-CurtoRissoPL+HernandezAC-JApplPhys}, and of Wiebe~\cite{2013-MartinsJJG-Publindustria}  (exponential)
    forms---so that $g(\theta) = 0$, $g(\theta+\delta) = 1$, with $g(\alpha)$ being monotonic in the  $\theta  \leqslant  \alpha
    \leqslant \delta + \theta$ interval---$\theta$ is the ignition angle, so that combustion starts whenever $\alpha =  \theta$,
    and $\delta = \omega\Delta t_c$ is the angular duration of the combustion, and $\Delta t_c$ is  the  time  duration  of  the
    combustion process---so that
    %
    \begin{equation}
        y(\alpha) =
        \begin{cases}
            0         & \text{for } \alpha < \theta, \\
            g(\alpha) & \text{for } \theta \leqslant \alpha \leqslant \theta + \delta, \\
            1         & \text{for } \alpha > \theta + \delta.
        \end{cases}
        \label{def:y}
    \end{equation}


